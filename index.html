<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Patient Review</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>
  <script src="https://unpkg.com/@popperjs/core@2"></script>
</head>

<body class="bg-gray-50 text-gray-800">
  <!-- Header -->
  <header class="bg-white shadow-md py-6 sticky top-0 z-50">
    <div class="container mx-auto px-4">
      <h1 class="text-3xl font-bold text-indigo-600">
        Hospital Feedback Portal
      </h1>
    </div>
  </header>

  <!-- Hero Banner -->
  <section class="bg-white py-12 mb-4" style="
        background-image: url('https://img.freepik.com/free-vector/office-workers-analyzing-researching-business-data_74855-4445.jpg?t=st=1754396511~exp=1754400111~hmac=15ed68daf8c8ffd1de0a30d8e9aa55c62c46cfd89bc1f2b4b724f552355657f2&w=1480');
        background-size: cover;
        background-position: center;
      ">
    <div class="bg-white/80 py-10 px-6 max-w-3xl mx-auto rounded shadow text-center animate-fade-in-down">
      <h2 class="text-3xl font-bold text-gray-900 mb-4">
        We Value Your Feedback!
      </h2>
      <p class="text-gray-700 mb-6">
        Tell us about your experience so we can improve and serve you better.
      </p>
      <a href="#form"
        class="inline-block px-6 py-3 bg-primary text-black font-semibold rounded shadow hover:bg-yellow-400 transition">Leave
        Feedback</a>
    </div>
  </section>

  <!-- Main Section -->
  <main class="container mx-auto px-4">
    <div class="max-w-xl mx-auto bg-blue-100 rounded-xl shadow-lg p-8 animate-fade-in">
      <h2 class="text-2xl font-semibold text-center mb-6">
        Rate Your Experience
      </h2>

      <!-- Star Rating -->
      <div id="ratingSection" class="flex justify-center gap-2 text-4xl mb-6">
        <span class="star cursor-pointer text-gray-400 hover:scale-110 transition-transform" data-value="1">★</span>
        <span class="star cursor-pointer text-gray-400 hover:scale-110 transition-transform" data-value="2">★</span>
        <span class="star cursor-pointer text-gray-400 hover:scale-110 transition-transform" data-value="3">★</span>
        <span class="star cursor-pointer text-gray-400 hover:scale-110 transition-transform" data-value="4">★</span>
        <span class="star cursor-pointer text-gray-400 hover:scale-110 transition-transform" data-value="5">★</span>
      </div>

      <!-- Form -->
      <div id="formSection" class="space-y-4 hidden">
        <input id="nameInput" type="text" placeholder="Your Name"
          class="w-full p-3 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500" />
        <input id="mobileInput" type="text" placeholder="Mobile Number"
          class="w-full p-3 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500" />
        <textarea id="feedbackInput" placeholder="Your Feedback (optional)" rows="3"
          class="w-full p-3 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"></textarea>
        <!-- Yes/No Questions -->
        <div id="questionsSection" class="space-y-4">
          <!-- Question 1 -->
          <div>
            <p class="font-medium">
              1. How satisfied are you with the quality of our cleaning and
              ironing?
            </p>
            <label class="mr-4">
              <input type="radio" name="q1" value="Satisfied" />Satisfied
            </label>
            <label>
              <input type="radio" name="q1" value="Not satisfied" />Not
              satisfied
            </label>
          </div>

          <!-- Question 2 -->
          <div>
            <p class="font-medium">
              2. Was your order ready on time as promised?
            </p>
            <label class="mr-4">
              <input type="radio" name="q2" value="Yes" /> Yes
            </label>
            <label> <input type="radio" name="q2" value="No" /> No </label>
          </div>

          <!-- Question 3 -->
          <div>
            <p class="font-medium">
              3. What can we do to improve your experience with us?
            </p>

            <label class="mr-4">
              <input type="radio" name="q3" value="Better product/service quality" />
              Better product/service quality
            </label>
            <label>
              <input type="radio" name="q3" value="Faster support and assistance" />
              Faster support and assistance
            </label>
          </div>
        </div>

        <button onclick="submitReview()"
          class="w-full bg-indigo-600 text-white py-3 rounded-md hover:bg-indigo-700 transition">
          Submit Review
        </button>
        <p id="thankYou" class="text-green-600 text-center hidden font-medium"></p>
      </div>
    </div>
    <!-- FAQ Section -->
    <section class="max-w-3xl mx-auto my-10 px-4">
      <h3 class="text-2xl font-semibold text-center text-indigo-600 mb-6">
        Frequently Asked Questions
      </h3>

      <div class="space-y-4">
        <details class="bg-white border rounded-lg p-4 shadow-sm">
          <summary class="cursor-pointer text-lg font-medium text-gray-800">
            How do I submit feedback?
          </summary>
          <p class="mt-2 text-gray-600">
            Simply select a star rating, fill in your name and mobile number,
            and submit your feedback using the form.
          </p>
        </details>

        <details class="bg-white border rounded-lg p-4 shadow-sm">
          <summary class="cursor-pointer text-lg font-medium text-gray-800">
            Will my information be kept private?
          </summary>
          <p class="mt-2 text-gray-600">
            Yes, your information is securely stored and only used to improve
            our services.
          </p>
        </details>

        <details class="bg-white border rounded-lg p-4 shadow-sm">
          <summary class="cursor-pointer text-lg font-medium text-gray-800">
            What happens if I give a 5-star rating?
          </summary>
          <p class="mt-2 text-gray-600">
            If you give a 5-star rating, you’ll be redirected to our official
            Google review page to share your public testimonial.
          </p>
        </details>

        <details class="bg-white border rounded-lg p-4 shadow-sm">
          <summary class="cursor-pointer text-lg font-medium text-gray-800">
            Can I update or remove my review?
          </summary>
          <p class="mt-2 text-gray-600">
            Please contact our support team with your registered details to
            make any changes to your submitted review.
          </p>
        </details>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="bg-white mt-10 py-4 shadow-inner">
    <div class="text-center text-gray-600 text-sm">
      &copy; 2025 Hospital Feedback System. All rights reserved.
    </div>
  </footer>

  <!-- Insert this inside your existing <script> block near the bottom -->
  <script>
    const firebaseConfig = {
      apiKey: 'AIzaSyCF7UrWZXkcnquHhfeTvnDee7Sm1qByEVc',
      authDomain: "feedify-review-app.firebaseapp.com",
      projectId: "feedify-review-app",
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const hospitalId = 'xyz_hospital';
    let selectedRating = 0;

    const stars = document.querySelectorAll('.star');
    const formSection = document.getElementById('formSection');

    const googleReviewURL = 'https://www.google.com/maps/place/XYZ+Hospital'; // Replace with your hospital's actual review link

    stars.forEach((star) => {
      star.addEventListener('click', () => {
        selectedRating = parseInt(star.getAttribute('data-value'));
        stars.forEach((s) => {
          s.classList.remove('text-yellow-400');
          if (parseInt(s.getAttribute('data-value')) <= selectedRating) {
            s.classList.add('text-yellow-400');
          }
        });

        // ✅ Logic for redirect
        if (selectedRating >= 5) {
          window.location.href = googleReviewURL;
        } else {
          formSection.classList.remove('hidden');
        }
      });
    });

    function submitReview() {
      const name = document.getElementById('nameInput').value.trim();
      const mobile = document.getElementById('mobileInput').value.trim();
      const feedback = document.getElementById('feedbackInput').value.trim();

      // Get answers for the yes/no questions
      const q1 =
        document.querySelector('input[name="q1"]:checked')?.value || '';
      const q2 =
        document.querySelector('input[name="q2"]:checked')?.value || '';
      const q3 =
        document.querySelector('input[name="q3"]:checked')?.value || '';

      if (!name || !mobile || selectedRating === 0 || !q1 || !q2 || !q3) {
        alert(
          'Please fill all fields, select a rating, and answer all questions.'
        );
        return;
      }

      if (!/^[6-9]\d{9}$/.test(mobile)) {
        alert('Please enter a valid 10-digit mobile number.');
        return;
      }

      const adModal = document.getElementById('adModal');
      const timerElement = document.getElementById('timer');
      let countdown = 25;

      adModal.classList.remove('hidden');
      timerElement.textContent = countdown;

      const interval = setInterval(() => {
        countdown--;
        timerElement.textContent = countdown;

        if (countdown === 0) {
          clearInterval(interval);
          adModal.classList.add('hidden');

          db.collection('laundry-review')
            .add({
              name,
              mobile,
              rating: selectedRating,
              feedback,
              questions: [
                {
                  question:
                    'How satisfied are you with the quality of our cleaning and ironing?',
                  answer: q1,
                },
                {
                  question: 'Was your order ready on time as promised?',
                  answer: q2,
                },
                {
                  question:
                    ' What can we do to improve your experience with us?',
                  answer: q3,
                },
              ],
              hospital_id: hospitalId,
              createdAt: firebase.firestore.FieldValue.serverTimestamp(),
            })
            .then(() => {
              const thankYouMsg = document.getElementById('thankYou');
              thankYouMsg.textContent = `Thank you ${name} for your feedback!`;
              thankYouMsg.classList.remove('hidden');
              document.getElementById('nameInput').disabled = true;
              document.getElementById('mobileInput').disabled = true;
              document.getElementById('feedbackInput').disabled = true;
              document
                .querySelectorAll('input[type="radio"]')
                .forEach((input) => (input.disabled = true));
            })
            .catch((error) => {
              console.error('Error submitting review:', error);
              alert('Something went wrong. Please try again.');
            });
        }
      }, 1000);
    }
  </script>

  <!-- Advertisement Popup -->
  <div id="adModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
    <div class="bg-white rounded-lg p-6 shadow-xl text-center max-w-md w-full relative">
      <h2 class="text-xl font-bold mb-4 text-gray-800">Advertisement</h2>
      <img
        src="https://stackblitz.com/storage/blobs/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBCTlR5blFFPSIsImV4cCI6bnVsbCwicHVyIjoiYmxvYl9pZCJ9fQ==--20222b088e9e19680b434e9d00cb37f019e7b411/28bbd6eb39185cd9a3ac74f45f2f3ed3.jpg"
        alt="Advertisement" class="mx-auto mb-4 rounded" />
      <p class="text-gray-700 mb-2">
        Please wait <span id="timer">25</span> seconds...
      </p>
    </div>
  </div>
</body>

</html>